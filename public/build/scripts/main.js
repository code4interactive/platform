function showRequest(t,e,o){return $(".error").removeClass("error"),$(".field-error").remove(),$(".messageBox").empty(),$('button[type="submit"], input[type="submit"]').attr("disabled",!0),$(".processingIndicator").css("display","block"),!0}function showResponse(responseText,statusText,xhr,$form){$(".processingIndicator").css("display","none"),$('button[type="submit"], input[type="submit"]').attr("disabled",!1),$.platform._handleServerResponse(xhr),"undefined"!=typeof responseText.status&&"success"===responseText.status&&("undefined"!=typeof responseText.redirect&&($(".redirectOverlay").css("display","block"),window.location.replace(responseText.redirect)),"undefined"!=typeof responseText.eval&&eval("("+responseText.eval+")"))}function showFieldErrors(t,e){return"string"==typeof e&&(e=jQuery.parseJSON(e)),"object"!=typeof e?(console.log("form.js: Errors are not an object"),!1):(jQuery.each(e,function(e,o){for(var i="",n=0;n<o.length;n++)i+='<label id="'+e+'-error" class="error field-error" for="'+e+'">'+o[n]+"</label>";var r=t.find(".error-container[data-field-name='"+e+"']");("object"!=typeof r||0===r.length)&&(r=t.find(".error-container[name='"+e+"']"));var a=t.find("[data-field-name='"+e+"']");("object"!=typeof a||0===a.length)&&(a=t.find("[name='"+e+"']")),a.length&&(a.addClass("error"),"object"!=typeof r||0===r.length?a.parent().append(i):r.append(i))}),!0)}function showErrors(t,e,o,i){$('button[type="submit"], input[type="submit"]').attr("disabled",!1),$(".processingIndicator").css("display","none"),toastr.error("W przesłanym formularzu są błędy","Błąd formularza");try{var n=JSON.parse(t.responseText);if(null!==n&&"object"==typeof n&&("formErrors"in n&&showFieldErrors(i,n.formErrors),"message"in n)){({formErrors:n.message});showFieldErrors(i,n.message)}}catch(r){}return $.platform._handleServerError(t,e,o),!0}function ajaxSuccess(){}function code4Loading(t){"start"==t?$("#code4-loading").css("right","0px"):$("#code4-loading").css("right","-135px")}!function(t){t.fn.gritter=t.gritter={},t.fn.gritter.options=t.gritter.options={position:"",addPosition:"bottom",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,time:6e3},t.fn.gritter.add=t.gritter.add=function(t){try{return e.add(t||{})}catch(o){var i="Gritter Error: "+o;"undefined"!=typeof console&&console.error?console.error(i,t):alert(i)}},t.fn.gritter.remove=t.gritter.remove=function(t,o){e.removeSpecific(t,o||{})},t.fn.gritter.removeAll=t.gritter.removeAll=function(t){e.stop(t||{})};var e={position:"",addPosition:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(o){if("string"==typeof o&&(o={text:o}),null===o.text)throw'You must supply "text" parameter.';this._is_setup||this._runSetup();var i=o.title,n=o.text,r=o.image||"",a=o.sticky||!1,s=o.hover_state||!0,c=o.class_name||t.gritter.options.class_name,l=t.gritter.options.position,d=o.close_icon||this._tpl_close,u=o.time||"";this._verifyWrapper(),this._item_count++;var p=this._item_count,f=this._tpl_item;t(["before_open","after_open","before_close","after_close"]).each(function(i,n){e["_"+n+"_"+p]=t.isFunction(o[n])?o[n]:function(){}}),this._custom_timer=0,u&&(this._custom_timer=u);var h=""!==r?'<img src="'+r+'" class="gritter-image" />':"",m=""!==r?"gritter-with-image":"gritter-without-image";if(i=i?this._str_replace("[[title]]",i,this._tpl_title):"",f=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[i,n,d,h,this._item_count,m,c],f),this["_before_open_"+p]()===!1)return!1;"top"===this.addPosition?t("#gritter-notice-wrapper").addClass(l).prepend(f):t("#gritter-notice-wrapper").addClass(l).append(f);var v=t("#gritter-item-"+this._item_count);return v.fadeIn(this.fade_in_speed,function(){e["_after_open_"+p](t(this))}),a||this._setFadeTimer(v,p),t(v).bind("mouseenter mouseleave",function(o){"mouseenter"===o.type?a||e._restoreItemIfFading(t(this),p):a||e._setFadeTimer(t(this),p),"no"!==s&&e._hoverState(t(this),o.type)}),t(v).find(".gritter-close").click(function(){e.removeSpecific(p,{},null,!0)}),p},_countRemoveWrapper:function(e,o,i){o.remove(),this["_after_close_"+e](o,i),0===t(".gritter-item-wrapper").length&&t("#gritter-notice-wrapper").remove()},_fade:function(t,o,i,n){var i=i||{},r="undefined"!=typeof i.fade?i.fade:!0,a=i.speed||this.fade_out_speed,s=n;this["_before_close_"+o](t,s),n&&t.unbind("mouseenter mouseleave"),r?t.animate({opacity:0},a,function(){t.animate({height:0},300,function(){e._countRemoveWrapper(o,t,s)})}):this._countRemoveWrapper(o,t)},_hoverState:function(t,e){"mouseenter"==e?(t.addClass("hover"),t.find(".gritter-close").show()):(t.removeClass("hover"),t.find(".gritter-close").hide())},removeSpecific:function(e,o,i,n){if(!i)var i=t("#gritter-item-"+e);this._fade(i,e,o||{},n)},_restoreItemIfFading:function(t,e){clearTimeout(this["_int_id_"+e]),t.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in t.gritter.options)this[opt]=t.gritter.options[opt];this._is_setup=1},_setFadeTimer:function(t,o){var i=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+o]=setTimeout(function(){e._fade(t,o)},i)},stop:function(e){var o=t.isFunction(e.before_close)?e.before_close:function(){},i=t.isFunction(e.after_close)?e.after_close:function(){},n=t("#gritter-notice-wrapper");o(n),n.fadeOut(function(){t(this).remove(),i()})},_str_replace:function(t,e,o,i){var n=0,r=0,a="",s="",c=0,l=0,d=[].concat(t),u=[].concat(e),p=o,f=u instanceof Array,h=p instanceof Array;for(p=[].concat(p),i&&(this.window[i]=0),n=0,c=p.length;c>n;n++)if(""!==p[n])for(r=0,l=d.length;l>r;r++)a=p[n]+"",s=f?void 0!==u[r]?u[r]:"":u[0],p[n]=a.split(d[r]).join(s),i&&p[n]!==a&&(this.window[i]+=(a.length-p[n].length)/d[r].length);return h?p:p[0]},_verifyWrapper:function(){0==t("#gritter-notice-wrapper").length&&t("body").append(this._tpl_wrap)}}}(jQuery),function(t){"use strict";function e(){var t=document.createElement("mm"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var o in e)if(void 0!==t.style[o])return{end:e[o]};return!1}function o(e){return this.each(function(){var o=t(this),i=o.data("mm"),r=t.extend({},n.DEFAULTS,o.data(),"object"==typeof e&&e);i||o.data("mm",i=new n(this,r)),"string"==typeof e&&i[e]()})}t.fn.emulateTransitionEnd=function(e){var o=!1,n=this;t(this).one("mmTransitionEnd",function(){o=!0});var r=function(){o||t(n).trigger(i.end)};return setTimeout(r,e),this};var i=e();i&&(t.event.special.mmTransitionEnd={bindType:i.end,delegateType:i.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}});var n=function(e,o){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,o),this.transitioning=null,this.init()};n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0,doubleTapToGo:!1,activeClass:"active",collapseClass:"collapse",collapseInClass:"in",collapsingClass:"collapsing"},n.prototype.init=function(){var e=this,o=this.options.activeClass,i=this.options.collapseClass,n=this.options.collapseInClass;this.$element.find("li."+o).has("ul").children("ul").attr("aria-expanded",!0).addClass(i+" "+n),this.$element.find("li").not("."+o).has("ul").children("ul").attr("aria-expanded",!1).addClass(i),this.options.doubleTapToGo&&this.$element.find("li."+o).has("ul").children("a").addClass("doubleTapToGo"),this.$element.find("li").has("ul").children("a").on("click.metisMenu",function(i){var n=t(this),r=n.parent("li"),a=r.children("ul");return i.preventDefault(),r.hasClass(o)&&!e.options.doubleTapToGo?(e.hide(a),n.attr("aria-expanded",!1)):(e.show(a),n.attr("aria-expanded",!0)),e.options.doubleTapToGo&&e.doubleTapToGo(n)&&"#"!==n.attr("href")&&""!==n.attr("href")?(i.stopPropagation(),void(document.location=n.attr("href"))):void 0})},n.prototype.doubleTapToGo=function(t){var e=this.$element;return t.hasClass("doubleTapToGo")?(t.removeClass("doubleTapToGo"),!0):t.parent().children("ul").length?(e.find(".doubleTapToGo").removeClass("doubleTapToGo"),t.addClass("doubleTapToGo"),!1):void 0},n.prototype.show=function(e){var o=this.options.activeClass,r=this.options.collapseClass,a=this.options.collapseInClass,s=this.options.collapsingClass,c=t(e),l=c.parent("li");if(!this.transitioning&&!c.hasClass(a)){l.addClass(o),this.options.toggle&&this.hide(l.siblings().children("ul."+a).attr("aria-expanded",!1)),c.removeClass(r).addClass(s).height(0),this.transitioning=1;var d=function(){c.removeClass(s).addClass(r+" "+a).height("").attr("aria-expanded",!0),this.transitioning=0};return i?void c.one("mmTransitionEnd",t.proxy(d,this)).emulateTransitionEnd(n.TRANSITION_DURATION).height(c[0].scrollHeight):d.call(this)}},n.prototype.hide=function(e){var o=this.options.activeClass,r=this.options.collapseClass,a=this.options.collapseInClass,s=this.options.collapsingClass,c=t(e);if(!this.transitioning&&c.hasClass(a)){c.parent("li").removeClass(o),c.height(c.height())[0].offsetHeight,c.addClass(s).removeClass(r).removeClass(a),this.transitioning=1;var l=function(){this.transitioning=0,c.removeClass(s).addClass(r).attr("aria-expanded",!1)};return i?void c.height(0).one("mmTransitionEnd",t.proxy(l,this)).emulateTransitionEnd(n.TRANSITION_DURATION):l.call(this)}};var r=t.fn.metisMenu;t.fn.metisMenu=o,t.fn.metisMenu.Constructor=n,t.fn.metisMenu.noConflict=function(){return t.fn.metisMenu=r,this}}(jQuery),$(document).ready(function(){$(document.body).on("click",'form.ajax button[type="submit"], form.ajax input[type="submit"]',function(){var t={beforeSubmit:showRequest,success:showResponse,error:showErrors,type:"post",dataType:"json"};$("form.ajax").ajaxForm(t)}),$(document.body).on("click",".confirmDelete",function(t){var e='Czy napewno usunąć "'+$(this).data("name")+'"?';return confirm(e)})}),$(document).ready(function(){$(document.body).on("click",".loadInModal",function(t){t.preventDefault();var e=$(this).attr("href");return $.ajax({url:e,method:"get",success:function(t){$id=$(t).find(".modal").attr("id"),$(t).modal("show")},error:function(t){}}),!1}),$(document.body).on("click","[data-modal]",function(t){t.preventDefault();var e;return""!==$(this).attr("data-modal")?e=$(this).attr("data-modal"):""!==$(this).attr("href")&&(e=$(this).attr("href")),""===e?void console.log("No target/url for modal"):"#"===e.substr(0,1)||"."===e.substr(0,1)?void $(e).modal("show"):($.ajax({url:e,method:"get",success:function(t){$(t).modal("show")},error:function(t){}}),!1)}),$(document.body).on("click",".editModal",function(t){t.preventDefault();var e=$(this).attr("href");return $.ajax({url:e,method:"get",success:function(t){$id=$(t).find(".modal").attr("id"),$(t).modal("show")},error:function(t){}}),!1})}),function(t,e,o){"use strict";function i(i){this.opt=t.extend({},n,i),this.$body=t(o.body),this.$window=t(e)}var n={activityFeedUrl:"/getActivityFeed",watchThreadUrl:"/watchThread"};i.prototype={_init:function(){var e=this;t("[data-action=getActivityFeed]").each(function(t,o){e.getActivityFeed(o)}),t(o).on("click","[data-action=watchThread]",function(){var o=t(this).attr("data-thread");e.watchThread(o)})},getActivityFeed:function(e){var o=this,i=t(e).attr("data-activity-feed"),n={feedSubject:i};return t(".processingIndicator").css("display","block"),t.ajax({url:o.opt.activityFeedUrl,async:!0,global:!1,type:"POST",data:n,dataType:"html",success:function(i,n,r){t(".processingIndicator").css("display","none"),o.showFeed(i,e)},error:function(e,i,n){t(".processingIndicator").css("display","none"),o._handleServerError(e,i,n)}}),null},watchThread:function(e){var o=this;t.ajax({url:o.opt.watchThreadUrl+"/"+e,async:!0,global:!1,type:"GET",dataType:"json",success:function(e,o,i){t.platform._handleServerResponse(i)},error:function(t,e,i){o._handleServerError(t,e,i)}})},reloadFeed:function(e){var o=this;t("[data-activity-feed="+e+"]").each(function(t,e){o.getActivityFeed(e)})},_handleServerError:function(e,o,i){t.platform._handleServerError(e,o,i)},showFeed:function(e,o){t(o).html(e)}},t.activity=new i}(jQuery,window,document),function($,window,document){"use strict";function Platform(t){this.opt=$.extend({},defaults,t),this.$body=$(document.body),this.$window=$(window),this.userId=currentUserId}var defaults={path_assets:"/packages/code4/platform/",menuMinified:!1};Platform.prototype={_init:function(){var t=this;$("[rel=tooltip],[data-rel=tooltip]").tooltip({html:!0}),$("[rel=popover],[data-rel=popover]").popover({html:!0}),$("#testReload").on("click",function(){$.ajax({url:"/testReload",async:!1,global:!1,type:"GET",dataType:"json",success:function(e,o,i){t._handleServerResponse(i)},error:function(e,o,i){t._handleServerError(e,o,i)}})}),this._timers()},_timers:function(){},store:function(t,e){},login:function(){},lockout:function(){var t=this;$.ajax({url:"/lockout/"+t.userId,async:!1,global:!1,type:"GET",dataType:"html",success:function(e,o,i){t.$body.find(".fullScreenModal").remove(),t.$body.addClass("modal-open"),t.$body.append('<div class="fullScreenModal gray-bg animated slideInDown">'+e+"</div>")},error:function(e,o,i){t._handleServerError(e,o,i)}})},lockoutExit:function(){var t=this;t.$body.removeClass("modal-open"),$(".fullScreenModal").removeClass("slideInDown").addClass("slideOutUp").delay(100).remove()},_handleServerResponse:function(jqXHR){var self=this;if(200==jqXHR.status){var responseText=JSON.parse(jqXHR.responseText);"actions"in responseText&&$.each(responseText.actions,function(i,actions){for(var action in actions){var command=actions[action];"exitLockout"===action&&self.lockoutExit(),"redirect"===action&&window.location.replace(command),"reloadFeed"===action&&$.activity.reloadFeed(command),"reload"===action&&window.location.reload(command),"eval"===action&&eval(command),"checkNotifications"===action&&$.notifications.check(),"notifications"===action&&$.notifications.handleNotifications(command),"reloadDataTable"===action&&$(command).DataTable().ajax.reload(null,!1)}})}},_handleServerError:function(t,e,o){console.log(t);401==t.status?$.platform.lockout():302==t.status?(console.log("redirect "+t.responseText),window.location.replace(t.responseText)):403==t.status?$.notifications.showError("Brak uprawnień","Nie masz uprawnień do tego zasobu!"):500==t.status&&$.notifications.showError("Błąd serwera","Jeśli będzie się powtarzał, skontaktuj się z administratorem!")}},$.platform=new Platform}(jQuery,window,document),$(document).ready(function(){$.platform._init(),$.notifications._init(),$.notifications.check(),$.activity._init(),$(document).ajaxSuccess(function(t,e,o){}),$(document).ajaxComplete(function(t,e,o){})});var slug=function(t){t=t.replace(/^\s+|\s+$/g,""),t=t.toLowerCase();for(var e="ąãàáäâęẽèéëêìíïîõòóöôùúüûñńçćśłżź·/_,:;",o="aaaaaaeeeeeeiiiiooooouuuunnccslzz------",i=0,n=e.length;n>i;i++)t=t.replace(new RegExp(e.charAt(i),"g"),o.charAt(i));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")};$(document).ready(function(){$("#top-search").on("focusin",function(){$(this).val().length>2&&$(".search-dropdown").show()}),$("body").not(".search-dropdown, #top-search").on("click",function(t){$(".search-dropdown").hide()})});
//# sourceMappingURL=main.js.map
